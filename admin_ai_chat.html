<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ­ÙƒÙ… AI: Ø¥Ø¶Ø§ÙØ© Ù…Ø³Ù„Ø³Ù„Ø§Øª</title>
    <style>
        /* ğŸ”¥ğŸ”¥ Ø§Ù„Ù€ CSS Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ ğŸ”¥ğŸ”¥ */
        :root {
            --bg-color: #0d0d0d; 
            --card-color: #1a1a1a; 
            --text-color: #e0e0e0; 
            --accent-color: #e50914; 
            --primary-color: #007bff;
        }
        body {
            font-family: 'Arial', sans-serif;
            background: radial-gradient(circle at top, #141414, #000);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .container {
            background-color: var(--card-color);
            padding: 20px;
            border-radius: 12px;
            max-width: 900px;
            width: 100%;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
        }
        h1 { color: var(--accent-color); margin-bottom: 10px; text-align: center; }
        
        /* ğŸ”¥ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ù„Ø£Ù…Ø§Ù† */
        #settings-area {
            background-color: #333;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: right;
        }
        #api-key-input {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            border-radius: 5px;
            border: none;
            background-color: #1a1a1a;
            color: lightgreen;
        }

        /* ğŸ”¥ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© ÙˆØ§Ù„Ù†ØªØ§Ø¦Ø¬ */
        #chat-window {
            height: 400px;
            background-color: #111;
            border: 1px solid #444;
            border-radius: 8px;
            overflow-y: scroll;
            padding: 15px;
            margin-bottom: 15px;
            text-align: right;
            white-space: pre-wrap;
        }
        #chat-window p {
            margin: 10px 0;
            padding: 8px;
            border-radius: 5px;
        }
        .user-message {
            background-color: #007bff;
            align-self: flex-end;
            text-align: right;
        }
        .ai-response {
            background-color: var(--accent-color);
            color: #fff;
            align-self: flex-start;
            text-align: right;
        }
        .ai-json {
             background-color: #0056b3;
             padding: 15px;
             font-family: monospace;
             font-size: 0.9em;
             cursor: pointer;
             margin-top: 10px;
        }
        .ai-json:hover {
            opacity: 0.9;
        }

        /* ğŸ”¥ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
        #input-area {
            display: flex;
            gap: 10px;
        }
        #prompt-input {
            flex-grow: 1;
            padding: 12px;
            border-radius: 5px;
            border: none;
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--text-color);
        }
        #submit-btn {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¤– Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Gemini AI</h1>
        
        <div id="settings-area">
            <p style="color: yellow;">âš ï¸ **Ø£Ù…Ø§Ù†!** Ø§Ù„Ù…ÙØªØ§Ø­ Ù…ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¢Ù† ÙÙŠ Ø§Ù„Ø­Ù‚Ù„ Ø£Ø¯Ù†Ø§Ù‡. Ù„Ø§ ØªØ´Ø§Ø±Ùƒ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©.</p>
            <input type="text" id="api-key-input" value="AIzaSyDTBvYaNGsNuQlaFjjtKlG9rlIbUvVuMJs" placeholder="GEMINI API KEY">
        </div>

        <div id="chat-window">
            <p style="color: #ccc; text-align: center;">Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ø±Ø³Ø§Ù„ Ø£Ù…Ø± Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ø³Ù„Ø³Ù„ Ø£Ùˆ ÙÙŠÙ„Ù… (Ù…Ø«Ø§Ù„: Ø£Ø¶Ù Ù…Ø³Ù„Ø³Ù„ The Last of Us Ù…Ø¹ Ø§Ù„Ù…ÙˆØ§Ø³Ù… 1 Ùˆ 2).</p>
        </div>

        <div id="input-area">
            <input type="text" id="prompt-input" placeholder="Ø£Ø¯Ø®Ù„ Ø£Ù…Ø± Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³Ù„Ø³Ù„/Ø§Ù„ÙÙŠÙ„Ù…...">
            <button id="submit-btn" onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„</button>
        </div>
        
        <p style="font-size: 0.9em; text-align: center; margin-top: 15px;">* Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ØŒ Ø§Ù†Ø³Ø® Ø§Ù„Ù€ JSON Ù…Ø¨Ø§Ø´Ø±Ø©Ù‹ Ù…Ù† Ø§Ù„Ø´Ø§Ø´Ø© ÙˆØ£Ù„ØµÙ‚Ù‡ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙŠØ¯ÙˆÙŠØ©.</p>
    </div>

    <script>
        const chatWindow = document.getElementById('chat-window');
        const promptInput = document.getElementById('prompt-input');
        const apiKeyInput = document.getElementById('api-key-input');

        // ğŸ”¥ğŸ”¥ğŸ”¥ Ø¯Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Gemini API ğŸ”¥ğŸ”¥ğŸ”¥
        async function callGeminiAPI(prompt) {
            const apiKey = apiKeyInput.value.trim(); // Ø³ÙŠÙ‚Ø±Ø£ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø°ÙŠ Ù‚Ù…Ù†Ø§ Ø¨Ù„ØµÙ‚Ù‡
            if (!apiKey) {
                appendMessage('AI', 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù„ØµÙ‚ Ù…ÙØªØ§Ø­ API Key Ø£ÙˆÙ„Ø§Ù‹!', 'ai-response');
                return null;
            }

            const SYSTEM_INSTRUCTION = `You are a movie database helper. Your task is to analyze the user's request (for a movie or series) and output ONLY a clean, valid JSON object. 
            
            Structure MUST include: "title", "description", "posterUrl" (placeholder), "releaseYear", "cast", "rating" (numeric out of 10), and "category". 
            
            If the user asks for EPISODES/SEASONS, you MUST include a "seasons" array, where each season has an "episodes" array, and each episode includes "episodeNumber", "title", "bunnyStreamLink" (placeholder), and "uqloadLink" (placeholder).
            
            DO NOT include any text before or after the JSON.`;

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${apiKey}`;
            
            const typingMessage = appendMessage('AI', 'Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙŠÙƒØªØ¨ Ø§Ù„Ø¢Ù†...', 'ai-response');

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ role: 'user', parts: [{ text: prompt }] }],
                        config: {
                            systemInstruction: SYSTEM_INSTRUCTION,
                            responseMimeType: "application/json",
                        }
                    })
                });

                if (!response.ok) {
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ÙØªØ§Ø­ Ø£Ùˆ Ø§Ù„Ø®Ø¯Ù…Ø©
                    const errorData = await response.json();
                    const errorMessage = errorData.error?.message || `HTTP Error: ${response.status}`;
                    throw new Error(errorMessage);
                }

                const data = await response.json();
                const jsonText = data.candidates[0]?.content?.parts[0]?.text.trim();
                
                if (typingMessage && typingMessage.parentNode) {
                    typingMessage.parentNode.removeChild(typingMessage);
                }

                if (jsonText) {
                    appendJSONResponse(jsonText);
                } else {
                    appendMessage('AI', 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª JSON Ù…Ù†Ø¸Ù…Ø©. Ø­Ø§ÙˆÙ„ Ø£Ù† ØªÙƒÙˆÙ† Ø£ÙƒØ«Ø± ØªØ­Ø¯ÙŠØ¯Ø§Ù‹ ÙÙŠ Ø·Ù„Ø¨Ùƒ.', 'ai-response');
                }

            } catch (error) {
                 if (typingMessage && typingMessage.parentNode) {
                    typingMessage.parentNode.removeChild(typingMessage);
                }
                appendMessage('AI', `âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: ${error.message}. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø£Ùˆ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù…ÙØªØ§Ø­ ÙŠØ¹Ù…Ù„.`, 'ai-response');
                console.error("Gemini API Error:", error);
            }
        }

        // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        function appendMessage(sender, text, className) {
            const messageElement = document.createElement('p');
            messageElement.className = className;
            messageElement.textContent = `${sender}: ${text}`;
            chatWindow.appendChild(messageElement);
            chatWindow.scrollTop = chatWindow.scrollHeight; // Ø§Ù„Ù†Ø²ÙˆÙ„ Ù„Ù„Ø£Ø³ÙÙ„
            return messageElement;
        }

        // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ ÙƒÙˆØ¯ JSON Ø§Ù„Ù‚Ø§Ø¨Ù„ Ù„Ù„Ù†Ø³Ø®
        function appendJSONResponse(jsonText) {
            appendMessage('AI', 'ØªÙ… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù†Ø³Ø®Ù‡:', 'ai-response');
            
            const jsonDiv = document.createElement('div');
            jsonDiv.className = 'ai-json';
            jsonDiv.textContent = jsonText;
            jsonDiv.onclick = () => {
                navigator.clipboard.writeText(jsonText);
                alert('ØªÙ… Ù†Ø³Ø® JSON. Ø§Ù„Ø¢Ù† Ø£Ù„ØµÙ‚Ù‡ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙŠØ¯ÙˆÙŠØ©.');
            };
            chatWindow.appendChild(jsonDiv);
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }


        // ğŸ”¥ğŸ”¥ Ø¯Ø§Ù„Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        function sendMessage() {
            const prompt = promptInput.value.trim();
            if (prompt === '') return;

            appendMessage('Ø£Ù†Ø§', prompt, 'user-message');
            callGeminiAPI(prompt);
            promptInput.value = '';
        }

        // Ø±Ø¨Ø· Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ùˆ Ø²Ø± Enter
        document.getElementById('submit-btn').addEventListener('click', sendMessage);
        promptInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
        
        // Ø±Ø¨Ø· Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ø¨Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        const backButton = document.createElement('a');
        backButton.href = 'index.html';
        backButton.className = 'back-btn';
        backButton.textContent = 'â†’ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©';
        document.body.prepend(backButton);

    </script>
</body>
</html>
